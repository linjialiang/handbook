# 使用 powershell 脚本批量拉取项目

## 脚本代码

ps1 脚本文件放在在项目上级目录，脚本内容如下：

```ps1
# 文件名： pull.ps1

# 子目录列表
$subdirectorys =
"debian-tutorial",
"help-tutorial",
"lnmp-tutorial",
"other-tutorial",
"vscode-tutorial",
"wamp-tutorial"

# 脚本所在目录
$dirParent = Split-Path -Parent $MyInvocation.MyCommand.Definition

Set-Location $dirParent
for ($i = 0; $i -lt $subdirectorys.Count; $i++) {
  $path = $subdirectorys[$i]
  Write-Output "===== $path ====="
  if ($i -ne 0) {
    Set-Location "../$path"
  }
  else {
    Set-Location $path
  }
  git pull
}
Set-Location ../
```

## 指令说明

### 比较运算符

| 代码         | 中文     |
| ------------ | -------- |
| -eq          | 等于     |
| -ne          | 不等于   |
| -gt          | 大于     |
| -ge          | 大于等于 |
| -lt          | 小于     |
| -le          | 小于等于 |
| -contains    | 包含     |
| -notcontains | 不包含   |

### 求反运算符

- `-not`
- `!`

### 布尔运算

| 代码 | 中文 |
| ---- | ---- |
| -and | 和   |
| -or  | 或   |
| -xor | 异或 |
| -not | 逆   |

### 常用指令

- 输出内容： `Write-Output 内容`
- 进入目录： `Set-Location 目录路径`
- 获取脚本绝对路径:

  ```ps1
  $filePath = $MyInvocation.MyCommand.Definition
  ```

- 获取脚本所在目录:

  ```ps1
  $dirPath = Split-Path -Parent $MyInvocation.MyCommand.Definition
  ```
